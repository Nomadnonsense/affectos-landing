<section id="waitlist" class="max-w-md mx-auto text-center mt-12">
  <h2 class="text-2xl font-semibold mb-4">Join the Waitlist</h2>
  <p class="text-gray-400 mb-6">Be the first to experience AffectOS when we launch.</p>

  <form id="waitlist-form" action="https://formspree.io/f/xldnqeod" method="POST" class="space-y-4">
    <input
      type="email"
      name="email"
      required
      placeholder="you@example.com"
      class="w-full px-4 py-3 rounded-md text-gray-800"
    />
    <button
      id="submit-btn"
      type="submit"
      class="w-full bg-indigo-600 hover:bg-indigo-700 py-3 rounded-md text-white font-semibold transition"
    >
      Join Now
      <span id="spinner" class="spinner hidden"></span>
    </button>
  </form>

  <p id="success-message" class="hidden text-green-400 mt-6 font-semibold">
    Thanks for joining the waitlist!
  </p>
  <p id="error-message" class="hidden text-red-500 mt-4 font-semibold"></p>

  <p class="text-xs text-gray-500 mt-4">Weâ€™ll never spam you. Unsubscribe anytime.</p>
</section>

<script>
  const form = document.getElementById('waitlist-form');
  const submitBtn = document.getElementById('submit-btn');
  const spinner = document.getElementById('spinner');
  const successMessage = document.getElementById('success-message');
  const errorMessage = document.getElementById('error-message');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    errorMessage.classList.add('hidden');
    submitBtn.disabled = true;
    spinner.classList.remove('hidden');

    const formData = new FormData(form);
    const action = form.getAttribute('action');

    try {
      const response = await fetch(action, {
        method: 'POST',
        body: formData,
        headers: { 'Accept': 'application/json' },
      });

      if (response.ok) {
        form.reset();
        form.style.display = 'none';
        successMessage.classList.remove('hidden');
      } else {
        const data = await response.json();
        errorMessage.textContent = data.error || 'Oops! There was a problem submitting your form.';
        errorMessage.classList.remove('hidden');
      }
    } catch (error) {
      errorMessage.textContent = 'Oops! There was a problem submitting your form.';
      errorMessage.classList.remove('hidden');
    } finally {
      submitBtn.disabled = false;
      spinner.classList.add('hidden');
    }
  });
</script>
